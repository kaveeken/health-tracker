{"id":"HT-0lh","title":"Add alias management via bot","description":"Currently requires editing aliases.json manually. Add bot command to add/list aliases, e.g., 'alias bp bench press'","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-10T19:09:21.16471486+01:00","created_by":"kris","updated_at":"2026-01-11T19:11:42.931392672+01:00","closed_at":"2026-01-11T19:11:42.931392672+01:00","close_reason":"Implemented alias management commands: alias \u003cterm\u003e (search), alias add, alias remove"}
{"id":"HT-1y9","title":"Manual end-to-end testing","description":"Run bot locally, test actual Telegram message flow for new entries, corrections, deletions, and queries","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T19:09:20.415498404+01:00","created_by":"kris","updated_at":"2026-01-10T19:09:20.415498404+01:00","labels":["testing"],"dependencies":[{"issue_id":"HT-1y9","depends_on_id":"HT-cnj","type":"blocks","created_at":"2026-01-10T19:19:18.584286814+01:00","created_by":"kris"}]}
{"id":"HT-2dw","title":"Create charts.py with common chart types","description":"Dedicated chart generation module with reusable functions for progress charts, volume breakdown, metric trends. Currently relies on Claude generating inline.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-10T19:09:20.556218737+01:00","created_by":"kris","updated_at":"2026-01-10T19:09:20.556218737+01:00"}
{"id":"HT-3zb","title":"Rework context to schema-validated conditions array","description":"Replace single context field with conditions array supporting multiple orthogonal values.\n\n**Syntax**: Bare words (no prefix), multiple allowed per entry since dimensions are orthogonal.\n\n**Dimensions** (entry type determines which apply):\n- Activity: waking, resting, active, post-workout (HR, HRV, Temp, CP)\n- Time of day: morning, evening (HRV, CP, Temp)\n- Metabolic: postprandial, fasted (HR, HRV, Temp)\n- Emotional: stressed, relaxed (HR)\n- Technique: oral, underarm, forehead_ir, ear (Temp only)\n\n**Note**: Technique merges into conditions as a dimension rather than a separate field. Simplifies model - one conditions array, parser validates which dimensions apply per entry type.\n\n**Examples**:\n- `hr 60 resting` → conditions: [resting]\n- `hr 60 resting pp` → conditions: [resting, postprandial]\n- `hrv 45 morning resting` → conditions: [morning, resting]\n- `temp 37.2 oral morning pp` → conditions: [oral, morning, postprandial]\n\n**Aliases**: Existing aliases still apply (pp → postprandial, rest → resting, ir → forehead_ir, etc.)\n\n**Migration**: \n- Existing context values → single-element conditions arrays\n- Existing technique values (temp) → merge into conditions array\n\n**Changes needed**: schema, parser, aliases","status":"open","priority":0,"issue_type":"feature","owner":"mail@krisveeken.nl","created_at":"2026-01-13T21:10:18.790832254+01:00","created_by":"Kris","updated_at":"2026-01-13T21:27:49.582170415+01:00"}
{"id":"HT-42u","title":"Database backup script","description":"Cron job to backup SQLite database. Could be simple cp to dated file or sync to remote.","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T19:09:21.926540174+01:00","created_by":"kris","updated_at":"2026-01-10T19:09:21.926540174+01:00"}
{"id":"HT-4xg","title":"Allow entry retrieval for messages with only a hash","description":"When a user sends a message containing only a hash (entry ID) with no replacement text, retrieve and display the corresponding entry instead of treating it as an edit attempt. This allows users to quickly look up previous entries by their hash.","status":"open","priority":2,"issue_type":"feature","owner":"mail@krisveeken.nl","created_at":"2026-01-13T20:47:05.644144616+01:00","created_by":"Kris","updated_at":"2026-01-13T20:47:27.45847195+01:00"}
{"id":"HT-50g","title":"Improve error recovery for Claude CLI failures","description":"What if Claude CLI fails mid-query, times out, or returns malformed output? Add better error handling and user feedback.","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T19:09:23.437727047+01:00","created_by":"kris","updated_at":"2026-01-10T19:09:23.437727047+01:00"}
{"id":"HT-5p5","title":"Test Raspberry Pi deployment","description":"Deploy to actual Pi, test systemd service, verify bot starts on boot and recovers from failures","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T19:09:22.67200196+01:00","created_by":"kris","updated_at":"2026-01-10T19:09:22.67200196+01:00","labels":["deployment"]}
{"id":"HT-bl4","title":"Add timezone support","description":"Timestamps are currently naive (no timezone). Could cause issues if user travels or system timezone differs. Consider storing UTC and converting for display.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-10T19:09:20.842780564+01:00","created_by":"kris","updated_at":"2026-01-10T19:09:20.842780564+01:00"}
{"id":"HT-cnj","title":"Configure Claude agent permissions for queries","description":"When bot.py spawns `claude -p` for queries, it needs pre-approved permissions to read the database. Currently no permission handling.\n\nOptions:\n1. CLI flag: `--allowedTools \"Bash(sqlite3*),Read,Write(/tmp/*)\"`\n2. Settings file: Configure ~/.claude/settings.json with allowlist\n3. MCP server: Create dedicated read-only database query tool\n\nTrade-offs:\n- Option 1: Simple, explicit per-invocation, but hardcoded in bot.py\n- Option 3: System-wide, cleaner bot.py, but requires Pi configuration\n- Option 4: Cleanest/safest, but more code to write and maintain","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T19:19:05.401666812+01:00","created_by":"kris","updated_at":"2026-01-10T19:47:37.847633151+01:00","closed_at":"2026-01-10T19:47:37.847633151+01:00","close_reason":"Added --allowedTools flag with Bash(sqlite3*), Bash(python*), Write(/tmp/*) to pre-approve permissions for database queries and chart generation."}
{"id":"HT-d5q","title":"Improve query prompt for Claude","description":"Current prompt in bot.py is basic. Add examples, common query patterns, chart generation guidelines.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-10T19:09:20.697055922+01:00","created_by":"kris","updated_at":"2026-01-10T19:09:20.697055922+01:00"}
{"id":"HT-gag","title":"Add parser tests","description":"Validate edge cases, reps formats (NxM, comma-separated), alias resolution, timestamp parsing (@time, @yesterday)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T19:09:20.274211901+01:00","created_by":"kris","updated_at":"2026-01-10T19:38:19.85952404+01:00","closed_at":"2026-01-10T19:38:19.85952404+01:00","close_reason":"Added 78 comprehensive tests covering: reps formats (NxM, comma-separated, single), alias resolution (exercises, HR contexts, temp techniques), timestamp parsing (@time, @yesterday, @date), all entry types, edge cases, error handling, format_response, and to_dict methods.","labels":["testing"]}
{"id":"HT-igt","title":"Add control pause (CP) entry type","description":"New health metric: control pause measured in seconds.\n\nInput examples:\n- `cp 35` → CP 35s ✓ [hash]\n- `cp 42 morning` → CP 42s (morning) ✓ [hash]\n\nImplementation:\n1. Add `control_pause` table to schema.sql (entry_id, seconds, context, timestamp)\n2. Add parser for `cp` prefix in parser.py\n3. Add ParsedControlPause dataclass\n4. Update db.py to handle new type\n5. Update aliases.json if needed","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-10T19:24:56.559746515+01:00","created_by":"kris","updated_at":"2026-01-11T19:45:17.416546198+01:00","closed_at":"2026-01-11T19:45:17.416546198+01:00","close_reason":"Implemented control pause (CP) entry type with morning/evening context"}
{"id":"HT-of8","title":"Add postprandial context for heart rate and body temperature","description":"Add \"postprandial\" (after eating) as a valid context for heart rate and body temperature measurements to track how meals affect these metrics.\n\nCurrently:\n- HR contexts are aliased via `hr_contexts` in aliases.json\n- Valid HR contexts hardcoded in parser.py:303: {'resting', 'post-workout', 'active', 'stressed'}\n- Body temperature only has `technique` field, no context support\n\nWork needed:\n1. Add 'postprandial' to valid HR contexts set in parser.py\n2. Add aliases (e.g., `pp`, `meal`, `fed`) → `postprandial` in aliases.json hr_contexts\n3. Add context support to body temperature parsing (currently only has technique)\n4. Add temp context aliases if needed\n5. Update tests","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-11T19:43:43.308531218+01:00","updated_at":"2026-01-11T19:54:15.80950304+01:00","closed_at":"2026-01-11T19:54:15.80950304+01:00","close_reason":"Implemented postprandial context for HR, HRV, and temperature. Added aliases (pp, fed, meal) and tests."}
{"id":"HT-vgi","title":"Add free-form context field with quoted string syntax","description":"Implement free-form context notes via quoted string syntax.\n\n**Syntax**: Double-quoted strings (e.g., \"after coffee\", \"didn't sleep well\")\n\n**Validation**: None - accepts arbitrary text\n\n**Storage**: Add `context TEXT` field to entry tables\n\n**Parsing order**: Extract quoted strings FIRST, before processing @tags or bare word conditions. This ensures quotes can contain any text without conflicting with other syntax.\n\n**Examples**:\n- `hr 60 \"after coffee\"` → context: \"after coffee\"\n- `hr 60 resting \"didn't sleep well\"` → conditions: [resting], context: \"didn't sleep well\"\n- `weight 85.2 @PS \"before workout\"` → tag: \"PS\", context: \"before workout\"\n\n**Combined syntax example**:\n`hr 60 resting pp @oura \"after coffee\"` → conditions: [resting, postprandial], tag: \"oura\", context: \"after coffee\"","status":"open","priority":0,"issue_type":"feature","owner":"mail@krisveeken.nl","created_at":"2026-01-13T21:10:20.083869991+01:00","created_by":"Kris","updated_at":"2026-01-13T21:24:17.871059101+01:00","dependencies":[{"issue_id":"HT-vgi","depends_on_id":"HT-3zb","type":"blocks","created_at":"2026-01-13T21:10:35.47780311+01:00","created_by":"Kris"}]}
{"id":"HT-zo9","title":"Add user-history validated @tags for sources/instruments","description":"Implement user-defined labels for sources/instruments with typo protection.\n\n**Syntax**: `@tag` prefix (e.g., @PS, @gym, @oura)\n\n**Storage**: New user_tags table tracking:\n- tag name\n- first_used timestamp\n- last_used timestamp  \n- use_count\n\n**Typo protection**:\n- Known tag → accept silently\n- Near-match (Levenshtein) → suggest correction: \"Did you mean @PS?\"\n- New tag → confirmation prompt: \"New tag @foo - confirm?\"\n\n**Query command**: List all tags with usage stats, query entries by tag\n\n**Parsing order**: Extract @tags after quoted strings, before bare word conditions\n\n**Examples**:\n- `weight 85.2 15% @PS` → tag: \"PS\"\n- `hr 60 resting @oura` → conditions: [resting], tag: \"oura\"","status":"open","priority":0,"issue_type":"feature","owner":"mail@krisveeken.nl","created_at":"2026-01-13T21:10:19.439546631+01:00","created_by":"Kris","updated_at":"2026-01-13T21:24:17.182460848+01:00","dependencies":[{"issue_id":"HT-zo9","depends_on_id":"HT-3zb","type":"blocks","created_at":"2026-01-13T21:10:35.295449059+01:00","created_by":"Kris"}]}
